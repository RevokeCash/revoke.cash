import { CheckCircleIcon, ExclamationTriangleIcon } from '@heroicons/react/24/outline';
import Button from 'components/common/Button';
import { shortenAddress } from 'lib/utils';
import { Exploit } from 'lib/utils/allowance-exploit-list';

interface Props {
  address: string;
  chainId: number;
  exploit: Exploit;
}

const HappyResult = (props: Props) => {
  return (
    <div className="rounded-md  border p-4 ">
      <div className="flex items-center gap-8 justify-between">
        <div className="flex-shrink-0">
          <CheckCircleIcon className="h-12 " aria-hidden="true" />
        </div>
        <div className="ml-3 flex-1">
          <h3 className="text-sm font-bold ">Happy days</h3>
          <div className="mt-2 text-sm ">
            <p>
              Your address {shortenAddress(props.address)} is not vulnerable to this exploit. Have look at all your
              allowances while you are here.
            </p>
          </div>
        </div>
        <Button
          className="hidden sm:flex"
          href={`/address/${props.address}?chainId=${props.chainId}`}
          size="md"
          style="secondary"
        >
          Check All Allowances
        </Button>
      </div>
      <Button
        className="sm:hidden mt-4 w-full"
        href={`/address/${props.address}?chainId=${props.chainId}`}
        size="md"
        style="secondary"
      >
        Check All Allowances
      </Button>
    </div>
  );
};

const SadResult = (props: Props) => {
  return (
    <div className="rounded-md border p-4 ">
      <div className="flex items-center gap-8 justify-between">
        <div className="flex-shrink-0">
          <ExclamationTriangleIcon className="h-12 " aria-hidden="true" />
        </div>
        <div className="ml-3 flex-1">
          <h3 className="text-sm font-bold ">Attention needed</h3>
          <div className="mt-2 text-sm ">
            <p>
              Your address {shortenAddress(props.address)} is vulnerable to this exploit. We recommend you to revoke the
              allowance for this address.
            </p>
          </div>
        </div>

        <Button
          size="md"
          style="secondary"
          className="hidden sm:flex"
          href={`/address/${props.address}?chainId=${props.chainId}&spenderSearch=${
            props.exploit.addresses.find((address) => address.chainId === props.chainId).address
          }`}
        >
          Revoke Allowance
        </Button>
      </div>
      <Button
        size="md"
        style="secondary"
        className="sm:hidden mt-4 w-full"
        href={`/address/${props.address}?chainId=${props.chainId}&spenderSearch=${
          props.exploit.addresses.find((address) => address.chainId === props.chainId).address
        }`}
      >
        Revoke Allowance
      </Button>
    </div>
  );
};

export const ExploitStatus = (props: Props & { happy: boolean }) => {
  return props.happy ? <HappyResult {...props} /> : <SadResult {...props} />;
};

export default ExploitStatus;
