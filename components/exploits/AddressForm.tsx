import { useAddressPageContext } from 'lib/hooks/page-context/AddressPageContext';
import { parseInputAddress } from 'lib/utils';
import useTranslation from 'next-translate/useTranslation';
import { useState } from 'react';
import AddressSearchBox from '../common/AddressSearchBox';
import ChainSelect from '../common/ChainSelect';

interface Props {
  chainIds?: number[];
  onSubmit: (address: string) => void;

  isSubmitting?: boolean;
}

export const AddressForm = (props: Props) => {
  const { t } = useTranslation();
  const [value, setValue] = useState<string>('');
  const { selectedChainId, selectChain } = useAddressPageContext();

  const handleSubmit = async (event: React.FormEvent<HTMLFormElement>) => {
    const address = event.target[0].value;
    const parsedAddress = await parseInputAddress(address);

    props.onSubmit(parsedAddress);
  };

  return (
    <div className="flex gap-2">
      <AddressSearchBox
        onSubmit={handleSubmit}
        onChange={(ev) => setValue(ev.target.value.trim())}
        value={value}
        placeholder={t('exploits:subpages.search.placeholder')}
        className="w-full text-base sm:text-lg"
      />
      <ChainSelect chainIds={props.chainIds} selected={selectedChainId} onSelect={selectChain} />
    </div>
  );
};

export default AddressForm;
