import LogIn from 'components/common/LogIn';
import { ExploitTable } from 'components/exploits/table/ExploitTable';
import PublicLayout from 'layouts/PublicLayout';
import { Exploit, getAllExploits } from 'lib/data/exploits-loader';
import { GetStaticProps, NextPage } from 'next';
import { DefaultSeo, NextSeo } from 'next-seo';
import useTranslation from 'next-translate/useTranslation';

interface Props {
  exploits: Exploit[];
}

const ExploitOverviewPage: NextPage<Props> = (props) => {
  const { t } = useTranslation();

  return (
    <>
      <NextSeo {...DefaultSeo} title={t('exploits:meta.title')} description={t('exploits:meta.description')} />

      <PublicLayout>
        {/* <AddressHeader /> */}
        <LogIn showSpinner>
          <h1 className="mb-4">Exploit Overview Page</h1>

          <ExploitTable exploits={props.exploits} />
        </LogIn>
      </PublicLayout>
    </>
  );
};

export const getStaticProps: GetStaticProps<Props> = async (context) => {
  const exploits = await getAllExploits();

  return {
    props: {
      exploits,
    },
  };
};

export const getStaticPaths = async () => {
  const exploits = await getAllExploits();

  return {
    paths: exploits.map((exploit) => ({
      params: {
        exploit_slug: exploit.slug,
      },
    })),
    fallback: false,
  };
};

export default ExploitOverviewPage;
